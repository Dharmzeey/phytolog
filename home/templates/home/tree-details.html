{% extends 'base/base.html' %}
{% load static %}
{% block content %}

{% block title %}
<title>
  {{ tree_info.scientific_name }} | Tree Database
</title>
{% endblock %}

<div class="tree-details">
  <div class="tree-info">
    <h1 class="tree-title">{{ tree_info.scientific_name }}</h1>
    
    {% if tree_info.leaf_image %}
    <img src="{{ tree_info.leaf_image.url }}" alt="{{ tree_info }}" class="tree-image mb-6" />
    {% endif %}
    
    <div class="tree-meta">
      {% if tree_info.common_name and tree_info.common_name != '------' %}
      <div class="meta-item">
        <span class="meta-label">Common Name</span>
        <span class="meta-value">{{ tree_info.common_name }}</span>
      </div>
      {% endif %}
      
      {% if tree_info.local_name and tree_info.local_name != '------' %}
      <div class="meta-item">
        <span class="meta-label">Local Name</span>
        <span class="meta-value">{{ tree_info.local_name }}</span>
      </div>
      {% endif %}
      
      {% if tree_info.authority %}
      <div class="meta-item">
        <span class="meta-label">Authority</span>
        <span class="meta-value">{{ tree_info.authority }}</span>
      </div>
      {% endif %}
      
      {% if tree_info.tree_order %}
      <div class="meta-item">
        <span class="meta-label">Order</span>
        <span class="meta-value">{{ tree_info.tree_order }}</span>
      </div>
      {% endif %}
      
      {% if tree_info.tree_family %}
      <div class="meta-item">
        <span class="meta-label">Family</span>
        <span class="meta-value">{{ tree_info.tree_family }}</span>
      </div>
      {% endif %}
      
      {% if tree_info.conservation_status %}
      <div class="meta-item">
        <span class="meta-label">Conservation Status</span>
        <span class="meta-value">{{ tree_info.conservation_status }}</span>
      </div>
      {% endif %}
      
      {% if tree_info.specie_status %}
      <div class="meta-item">
        <span class="meta-label">Species Status</span>
        <span class="meta-value">{{ tree_info.specie_status }}</span>
      </div>
      {% endif %}
    </div>
    
    {% if tree_info.tree_description %}
    <div class="mt-6">
      <h3 class="mb-4">Description</h3>
      <p>{{ tree_info.tree_description }}</p>
    </div>
    {% endif %}
    
    <div class="flex gap-4 mt-6">
      {% if tree_info.pharmacological_details %}
      <a href="{% url 'home:pharmacology' tree_info.id %}" class="btn btn-primary">
        Pharmacological Details
      </a>
      {% endif %}
      
      {% if tree_info.reference %}
      <a href="{{ tree_info.reference }}" target="_blank" class="btn btn-secondary">
        Learn More
      </a>
      {% endif %}
    </div>
  </div>

  <div class="locations-section">
    <h2 class="mb-6">Locations Found</h2>
    <div class="locations-grid">
      {% for location in tree_location %}
      <a href="{% url 'home:tree_picture' location.id %}" class="location-item" target="_blank">
        {{ location.location_name }}
        <p class="text-muted text-sm mt-2">{{ location.tree_count }} tree{{ location.tree_count|pluralize }}</p>
      </a>
      {% endfor %}
    </div>
    
    <!-- Pagination for locations -->
    {% if tree_location.has_other_pages %}
    <div class="pagination mt-8">
      {% if tree_location.has_previous %}
      <a href="?page=1">First</a>
      <a href="?page={{ tree_location.previous_page_number }}">&laquo;</a>
      {% else %}
      <span>&laquo;</span>
      {% endif %}

      {% for i in tree_location.paginator.page_range %}
        {% if tree_location.number == i %}
        <span class="active-page">{{ i }}</span>
        {% else %}
        <a href="?page={{ i }}">{{ i }}</a>
        {% endif %}
      {% endfor %}

      {% if tree_location.has_next %}
      <a href="?page={{ tree_location.next_page_number }}">&raquo;</a>
      <a href="?page={{ tree_location.paginator.num_pages }}">Last</a>
      {% else %}
      <span>&raquo;</span>
      {% endif %}
    </div>
    {% endif %}
  </div>
</div>

<div class="card mt-8">
  <p class="text-muted text-sm">
    Created: {{ tree_info.created|date:"F d, Y" }} | 
    Last updated: {{ tree_info.last_updated|date:"F d, Y" }}
  </p>
</div>

{% endblock %}